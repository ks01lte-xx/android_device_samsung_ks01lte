allow surfaceflinger sysfs_graphics:file rw_file_perms;
allow surfaceflinger mpctl_socket:dir r_dir_perms;
allow surfaceflinger sysfs_kgsl:dir search;
allow surfaceflinger sysfs_kgsl:file r_file_perms;
unix_socket_send(surfaceflinger, mpctl, mpdecision)
unix_socket_connect(surfaceflinger, mpctl, mpdecision)

set_prop(surfaceflinger, postprocessing_prop)

binder_call(surfaceflinger, location)
binder_call(surfaceflinger, tee)

# access to /data/vendor/display for dumping input frames
allow surfaceflinger display_vendor_data_file:dir create_dir_perms;
allow surfaceflinger display_vendor_data_file:file create_file_perms;

r_dir_file(surfaceflinger, firmware_file)

#Allow access to cameraserver service
allow surfaceflinger cameraserver_service:service_manager find;

#Allow access to binder callback's to camera hal
binder_call(surfaceflinger, hal_camera_default)

allow surfaceflinger qdisplay_service:service_manager { add find };

allow surfaceflinger {
    debug_gralloc_prop
}:file r_file_perms;

#set qemu.gles prop
set_prop(surfaceflinger, qemu_gles_prop)
