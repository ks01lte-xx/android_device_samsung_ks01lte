allow mediaserver tee_device:chr_file rw_file_perms;
allow mediaserver qdsp_device:chr_file r_file_perms;

allow mediaserver self:socket create_socket_perms_no_ioctl;

binder_call(mediaserver, rild)

allow mediaserver camera_data_file:sock_file w_file_perms;

allow mediaserver camera_data_file:dir rw_dir_perms;
allow mediaserver camera_data_file:file create_file_perms;
# Access to audio
allow mediaserver qti_debugfs:file rw_file_perms;

#This is required for thermal sysfs access
r_dir_file(mediaserver, sysfs_thermal);

#Allow mediaserver to set camera  properties
set_prop(mediaserver, camera_prop)

get_prop(mediaserver, exported_camera_prop);

# allow mediaserver to communicate with bootanim
binder_call(mediaserver, bootanim);

allow mediaserver surfaceflinger:unix_stream_socket rw_socket_perms;

qmux_socket(mediaserver)
unix_socket_send(mediaserver, camera, mm-qcamerad)

allow mediaserver mpctl_socket:dir r_dir_perms;
unix_socket_send(mediaserver, mpctl, mpdecision)
unix_socket_connect(mediaserver, mpctl, mpdecision)

unix_socket_connect(mediaserver, thermal, thermal-engine)

allow mediaserver sysfs_camera:dir search;
allow mediaserver sysfs_camera:file r_file_perms;
allow mediaserver vendor_file:file execmod;
