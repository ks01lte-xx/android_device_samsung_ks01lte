qmux_socket(rild);
#binder_use(rild)

allow rild ssr_device:chr_file r_file_perms;

r_dir_file(rild, sysfs_ssr)

binder_call(rild, mediaserver)
binder_call(rild, audioserver)
binder_call(audioserver, rild)

dontaudit rild domain:dir r_dir_perms;

#allow rild { mediaserver_service audioserver_service }:service_manager find;
allow rild toolbox_exec:file rx_file_perms;

allow rild self:socket ioctl;
allowxperm rild self:socket ioctl msm_sock_ipc_ioctls;

# qcril.so needs access to /vendor/radio/qcril_database/qcril.db
allow rild vendor_file:file lock;

binder_use(rild)
allow rild {
	mediaserver_service
	audioserver_service
}:service_manager find;

# rild reads qcril.db linked to /system/etc/qcril.db
allow rild radio_data_file:lnk_file read;

# allow rild to access radio data file
allow rild radio_data_file:dir rw_dir_perms;
allow rild radio_data_file:file create_file_perms;

set_prop(rild, net_radio_prop)
set_prop(rild, radio_prop)

allow rild alarm_device:chr_file rw_file_perms;

allow rild app_efs_file:dir search;
allow rild app_efs_file:file r_file_perms;
allow rild imei_efs_file:dir search;
allow rild imei_efs_file:file r_file_perms;

allow rild proc_net:file w_file_perms;
allow rild proc_qtaguid_stat:file r_file_perms;
allow rild sysfs_sec_key:file rw_file_perms;

allow rild diag_device:chr_file rw_file_perms;
